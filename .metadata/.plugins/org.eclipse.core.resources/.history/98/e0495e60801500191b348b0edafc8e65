package dao;
import java.beans.Statement;

import com.mysql.jdbc.*;

import metier.Bulletin;

public class BulletinDao 
{

	String user = "root", pass = "", strUrl = "jdbc:mysql://localhost:3306/project_breizhlink";
	Connection conn= null;
	Statement stat= null;
	String sql_ajout = "insert into user VALUES (?,?,?) ";
	String sql_affichage = "select login from user where login = ?";

	public void addBulletin(Bulletin bull)
	{
		// inser bull dans la table
		try 
		{
			// chargement du driver
			Class.forName("com.mysql.jdbc.Driver");
			// récupération de la connection
			conn = DriverManager.getConnection(strUrl,user,pass);
			// création dun statement
			stat = conn.createStatement();
			
			PreparedStatement pst2 = conn.prepareStatement(sql_affichage);
			pst2.setString(1, this.login);
			ResultSet rs = pst2.executeQuery();
			
			if (rs.next())
			{
				return false;
			}
			else
			{
				PreparedStatement pst = conn.prepareStatement(sql_ajout);
				pst.setString(1, this.login);
				pst.setString(2, this.email);
				pst.setString(3, this.password);
				pst.execute();
				return true;
			}
		}
		catch (ClassNotFoundException e) {
			e.printStackTrace();
			return false;} 
		catch (SQLException e) {
			e.printStackTrace();
			return false;}
	}
	}
}
